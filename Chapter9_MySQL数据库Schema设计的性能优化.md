# MySQL数据库Schema设计的性能优化

1. 高效的模型设计

    * 最规范的就一定是最合理的吗？

        对于基于性能的数据库Schema 设计，我们并不能完全以规范化范式理论来作为唯一的指导。在设计过程中，应该从实际需求出发，以性能提升为根本目标来展开设计工作，很多时候为了尽可能提高性能，我们必须做反范式设计。

    * 适度冗余- 让Query 尽两减少Join

        举例增加了冗余数据，提高查询效率。即使因为增加冗余数据，导致更新需要做更多的工作。但是考虑更新的次数远远低于进行查询的操作。整体还是提高了效率。

    * 大字段垂直分拆- summary 表优化

        跟适度冗余差不多是完全相反的优化策略。 适度冗余策略是将别的表中的字段拿过来在自己身上也存一份数据，而大字段垂直拆分简单来说就是将自己身上的字段拆分出去放在另外（单独）的表里面。

        前面我们将别人的字段那过来，是因为我们很多时候的查询需要使用该字段，为了减少Join 带来的性能消耗才拿过来的。而我们将大字段拿出去，也是将一些我们在大部分查询中并不需要使用该字段的时候才会拿出去. 

        将该大字段从原表中拆分出来，通过单独的表进行存放，让我们在访问其他数据的时候大大降低IO 访问，从而使性能得到较大的改善

        拆分原则为： 1. 字段数据较大 2. 访问频率较低  这两点都是相对而言。

    * 大表水平分拆- 基于类型的分拆优化

        访问频次较高，且内容改动较少，可以考虑单独形成一个表（eg. 置顶信息和讨论区信息）

    * 统计表- 准实时优化

        实时统计的性能消耗成本太高。 在短时间内的不够精确，又并不会带来太大用户体验的降低。所以完全可以通过定时任务程序，没隔一定时间段进行一次统计后存放在专门设计的统计表中

2. 合适的数据类型

    可以通过选择更小的数据类型来让数据库通过更小的空间存放相同的数据量，这对于检索同样的数据所带来的IO 消耗自然会降低，性能也就很自然得到了提升。

    由于CPU 对不同数据的处理方式不一样，就会造成不同类型的数据在各种运算处理如比较，排序等方面的处理效率存在差异。所以，对于我们需要经常进行比较计算以及排序等消耗CPU 资源的字段，应该尽量选择处理更为迅速的字段类型。如通过整数类型代替浮点数或者字符类型。


3. 规范对象命令

    1. 数据库和表名应尽可能和所服务的业务模块名一致；

        这样，在DBA 维护相关数据库对象的时候，新开发人员程序开发过程中，相关技术（或非技术）人员整理业务逻辑和数据关系的时候，都能够非常容易理解其中的关系。

    2. 服务于同一子模块的一类表尽量以子模块名（或部分单词）为前缀或后缀；

        对同类功能的表增加前缀或者后缀，也是让查看使用该表的各类人员能够很快的根据相关对象的名称就联想到相应的功能，以及相关业务。不论是从维护角度，还是从使用角度来看都会带来非常大的便利性。

    3. 表名应尽量包含与所存放数据相对应的单词；

        这对于新员工来说尤其重要，要想尽快的熟悉数据，尽快了解相关业务，快速的定位数据库中各表对应的数据意义是非常有帮助的。

    4. 字段名称也尽量保持和实际数据相对应这一点的意义我想各位读者朋友应该都非常的清楚，每个表都会有很多的字段对应数据的各种不同属性，要搞清楚各自代表的含义，除了完整规范的说明文档之外，命名清晰合理的字段名也是一个有用的补充，而且更为直接。

    5. 索引名称尽量包含所有的索引键字段名或者缩写，且各字段名在索引名中的顺序应与索引键在索引中的索引顺序一致，且尽量包含一个类似于idx 或者ind 之类的前缀或者后缀，以表名其对象类型是索引，同时还可以包含该索引所属表的名称；这样做最大的好处在于DBA 在维护过程中能够非常直接清晰的通过索引名称就了解到该索引大部分的信息。

    6. 约束等其他对象也应该尽可能包含所属表或其他对象的名称，以表名各自关系。

